{"version":3,"sources":["webpack:///$_lazy_route_resource lazy namespace object","webpack:///src/app/404/page-not-found.component.ts","webpack:///src/app/404/page-not-found.component.html","webpack:///src/app/app-routing.module.ts","webpack:///src/app/app.component.ts","webpack:///src/app/app.component.html","webpack:///src/app/app.module.ts","webpack:///src/app/client/client.component.ts","webpack:///src/app/client/client.component.html","webpack:///src/app/core/com.service.ts","webpack:///src/app/core/to-safe.pipe.ts","webpack:///src/app/manage/manage.component.ts","webpack:///src/app/manage/manage.component.html","webpack:///src/app/server/server.component.ts","webpack:///src/app/server/server.component.html","webpack:///src/app/shared/chat-content/chat-content.component.ts","webpack:///src/app/shared/chat-content/chat-content.component.html","webpack:///src/app/shared/chat-unread/chat-unread.component.ts","webpack:///src/app/shared/chat-unread/chat-unread.component.html","webpack:///src/app/shared/edit-operate/edit-operate.component.ts","webpack:///src/app/shared/edit-operate/edit-operate.component.html","webpack:///src/app/shared/send-area/send-area.component.ts","webpack:///src/app/shared/send-area/send-area.component.html","webpack:///src/assets/js/calendar.js","webpack:///src/environments/environment.ts","webpack:///src/main.ts"],"names":["webpackEmptyAsyncContext","req","Promise","resolve","then","e","Error","code","keys","module","exports","id","PageNotFoundComponent","pageHeight","window","innerHeight","pageWidth","innerWidth","console","log","DATA","SDGS","onresize","event","selector","templateUrl","styleUrls","routes","path","loadChildren","mod","AuthModule","component","redirectTo","pathMatch","AppRoutingModule","forRoot","imports","AppComponent","com","AppModule","declarations","bootstrap","ClientComponent","route","chatList","keepEnd","files","editData","unreadOption","unread","scrollHeight","search","location","substring","random","Date","now","toString","pollingStart","chatElem","document","getElementById","getHistory","data","setTimeout","toBottom","scrollTop","content","isServer","position","push","sendListen","fileEmiter","ComService","http","router","alert","msg","show","previewOption","isShowMask","api","login","register","message","polling","history","userList","logout","userInfo","isLogin","isWindowActive","windowActive","date","fmt","replace","o","getFullYear","getMonth","getDate","getHours","getMinutes","getSeconds","Math","floor","S","getMilliseconds","test","RegExp","$1","substr","length","k","time","timestamp","createTime","getTime","diff","formatTime","hiddenProperty","visibilityChangeEvent","onVisibilityChange","addEventListener","onblur","onfocus","res","success","fail","showAlert","navigate","post","pipe","handleError","subscribe","doHttpResponse","uri","failCallback","error","dir","ErrorEvent","status","obj","domain","options","observe","get","myID","Number","headers","isNewConnect","ret","body","forEach","d","attachSPT","doPolling","file","callback","reader","FileReader","readAsDataURL","onload","target","result","fileObj","progressCallback","formData","FormData","append","reportProgress","request","type","UploadProgress","uploadProgress","round","loaded","total","src","key","fn","delay","timeout","clearTimeout","bind","arguments","fid","isISend","doType0","doType1","doType3","isCuUserSend","user","i","findIndex","x","readed","isUserInList","findeIndex","state","chatScrollTop","name","deskNotify","sendMsg","rid","userIndex","u","isInUserList","getUserInfo","unshift","mark","lastMsg","foreach","el","cb","isResponseObserv","reverse","isIsend","timeStr","timeFromNow","timeFormat","instance","onclick","focus","close","onerror","onshow","onclose","title","img","Notification","permission","icon","notifyInstanceEvent","requestPermission","index","clearInterval","timer","setInterval","titleElem","getElementsByName","innerText","providedIn","ToSafePipe","_sanitizer","value","args","toUpperCase","slice","ManageComponent","serverUrl","tabIndex","dataset","isNaN","changeTab","ServerComponent","rightShow","stateMenuShow","allHistory","rightHistory","isShowUserList","historyDate","isShowMonthCalendar","imgSrc","initCalendar","getUserList","note_at","tagName","toLowerCase","y","m","clickCb","nextMonthCb","nextYeayCb","prevMonthCb","prevYearCb","filter","indexOf","stopPropagation","toggle","closeHistory","getSpecialHistory","showStateMenu","showUserList","showMonthCalendar","rightHitoryShow","ChatContentComponent","ChatUnreadComponent","who","EditOperateComponent","historyEmiter","permitType","preview","emit","fileType","getFile","SendAreaComponent","hasHolder","editText","text","setEditDivUsable","changes","keepLastIndex","border","range","createRange","selectNodeContents","collapse","sel","getSelection","removeAllRanges","addRange","editFocus","cbd","clipboardData","ua","navigator","userAgent","items","kind","types","match","item","blob","getAsFile","size","preventDefault","selectAllChildren","collapseToEnd","setAttribute","innerHTML","keyCode","send","div","createElement","childNodes","removeChild","editTxt","trim","count","splice","uploadFile","err","isUploaded","span","Array","from","children","lastNode","appendChild","offline","editBlur","editInput","editKeyUp","editPaste","undefined","_global","extend","def","opt","override","hasOwnProperty","formartDate","symbol","Schedule","curDate","year","month","day","currentYear","currentMonth","currentDay","selectedDate","querySelector","_this","bindEvent","nextMonthFun","nextYearFun","prevMonthFun","prevYearFun","className","render","init","scheduleHd","scheduleWeek","scheduleBd","fullDay","startWeek","getDay","lastMonthDay","eleTemp","nowDate","addClass","join","eval","environment","production","bootstrapModule"],"mappings":"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","file":"main-es5.js","sourcesContent":["function webpackEmptyAsyncContext(req) {\n\t// Here Promise.resolve().then() is used instead of new Promise() to prevent\n\t// uncaught exception popping up in devtools\n\treturn Promise.resolve().then(function() {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t});\n}\nwebpackEmptyAsyncContext.keys = function() { return []; };\nwebpackEmptyAsyncContext.resolve = webpackEmptyAsyncContext;\nmodule.exports = webpackEmptyAsyncContext;\nwebpackEmptyAsyncContext.id = \"./$$_lazy_route_resource lazy recursive\";","import { Component, OnInit } from '@angular/core';\nimport {Router} from '@angular/router';\n\n@Component({\n  selector: 'app-page-not-found',\n  templateUrl: './page-not-found.component.html',\n  styleUrls: ['./page-not-found.component.css']\n})\nexport class PageNotFoundComponent implements OnInit {\n\n  constructor() { }\n\n  pageHeight: number;\n  pageWidth: number;\n\n  ngOnInit() {\n    this.pageHeight = window.innerHeight;\n    this.pageWidth = window.innerWidth;\n    console.log({\n      DATA: this.pageHeight,\n      SDGS:  this.pageWidth\n    })\n    window.onresize = (event) => {\n      this.pageHeight = window.innerHeight;\n      this.pageWidth = window.innerWidth;\n    };\n  }\n\n}\n","<div class=\"d-flex justify-content-center align-items-center \" style=\"font-size: 40px;height: 100%;\">\n  <div class=\"\">\n    <div style=\"font-size: 200%;\">404</div>\n    <div>Page Not Found</div>\n    <a [routerLink]=\"[ '/' ]\" [ngStyle]=\"{'font-size': '14px'}\">back to index page</a>\n  </div>\n</div>\n","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\nimport { ClientComponent } from './client/client.component';\nimport { ServerComponent } from './server/server.component';\nimport { ManageComponent } from './manage/manage.component';\nimport { PageNotFoundComponent } from './404/page-not-found.component';\nconst routes: Routes = [\n  { path:'auth',loadChildren:()=>import('./auth/auth.module').then(mod=>mod.AuthModule)},\n  { path: 'client', component: ClientComponent },\n  { path: 'server', component: ServerComponent  },\n  { path: 'manage', component: ManageComponent  },\n  { path:'',redirectTo:'/client',pathMatch:'full'},\n  { path: '**', component:   PageNotFoundComponent},\n];\n\n@NgModule({\n  imports: [RouterModule.forRoot(routes), FormsModule, ReactiveFormsModule],\n  exports: [RouterModule],\n})\nexport class AppRoutingModule {}\n","import { Component,OnInit } from '@angular/core';\nimport {ComService} from  './core/com.service'\n \n\n@Component({\n  selector: 'app-root',\n  templateUrl: './app.component.html',\n  styleUrls: ['./app.component.css'],\n})\nexport class AppComponent implements OnInit {\n  \n  constructor(public com :ComService){\n\n  }\n  ngOnInit(): void {    \n  }\n\n   \n  \n}\n"," \r\n<router-outlet></router-outlet>\r\n<div class=\"alert \" [class]=\"com.alert?.show?'':'d-none'\">{{com.alert?.msg}}</div>\r\n\r\n<div class=\"mask ie-scroll other-scroll\" *ngIf=\"com.previewOption.isShowMask\" (click)=\"com.previewOption.isShowMask= false\">\r\n    <img [src]=\"com.previewOption.src\"  onerror=\"this.src='/assets/images/error.jpg'\">\r\n</div>","import { BrowserModule } from '@angular/platform-browser';\nimport { NgModule } from '@angular/core';\nimport { AppRoutingModule } from './app-routing.module';\nimport { AppComponent } from './app.component';\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\nimport { HttpClientModule } from '@angular/common/http';\nimport { BrowserAnimationsModule } from '@angular/platform-browser/animations';\nimport { ClientComponent } from './client/client.component';\nimport { ServerComponent } from './server/server.component';\nimport { ManageComponent } from './manage/manage.component';\nimport { PageNotFoundComponent } from './404/page-not-found.component';\nimport { SendAreaComponent } from './shared/send-area/send-area.component';\nimport { EditOperateComponent } from './shared/edit-operate/edit-operate.component';\nimport { ChatContentComponent } from './shared/chat-content/chat-content.component';\nimport {ToSafePipe} from './core/to-safe.pipe';\nimport { ChatUnreadComponent } from './shared/chat-unread/chat-unread.component'\n\n\n@NgModule({\n  declarations: [\n    AppComponent,\n    ClientComponent,\n    ServerComponent,\n    ManageComponent,\n    PageNotFoundComponent,\n    SendAreaComponent,\n    EditOperateComponent,\n    ChatContentComponent,\n    ToSafePipe,\n    ChatUnreadComponent\n  ],\n  imports: [\n    BrowserModule,\n    AppRoutingModule,\n    FormsModule,\n    ReactiveFormsModule,\n    HttpClientModule,\n    BrowserAnimationsModule,\n    HttpClientModule\n  ],\n  bootstrap: [AppComponent]\n})\nexport class AppModule { }\n","import { Component, OnInit, SimpleChanges } from '@angular/core';\nimport { ActivatedRoute, Params } from '@angular/router';\nimport { ComService } from '../core/com.service';\n\n@Component({\n  selector: 'app-client',\n  templateUrl: './client.component.html',\n  styleUrls: ['./client.component.css'],\n})\nexport class ClientComponent implements OnInit {\n  constructor(private com: ComService, private route: ActivatedRoute) {}\n  chatList:any = [];\n  ws:any;\n  myID:number;\n  chatElem :any;\n  keepEnd:boolean = false;\n  // 文件列表\n  files :any []=[] ;\n  // 编辑框数组\n  editData:any =[];\n  cuFile:any ;\n  unreadOption:{unread:number,scrollHeight:number}={unread:0,scrollHeight:0};\n  ngOnInit(): void {\n    // domain=xx&mall=xxx\n    let search =  window.location.search.substring(1);  \n    let random = Date.now().toString();\n    this.com.pollingStart(this,random,search);\n    \n    this.chatElem = document.getElementById('chat');    \n  }\n  \n  getHistory(){\n      this.com.getHistory(this,null,(data)=>{\n      this.chatList = data || [];\n       setTimeout(()=>{\n        this.toBottom();  \n      },500)        \n    })\n  }\n  toBottom(){\n     this.chatElem.scrollTop = this.chatElem.scrollHeight  ;\n  }\n  \n  sendListen(content){    \n    content.isServer = false;\n    content.position= false;\n    this.chatList.push(content);\n  }\n  fileEmiter(e){\n    this.keepEnd = true;\n  }\n \n}\n","<div class=\"container  clearfix\" id=\"main\">\n\n  <div class=\"title bg-base noselect \" id=\"title\">\n    <img src=\"assets/images/logo.png\" ondragStar=\"return false\" class=\"vm\" id=\"logo\">\n    <span>在线客服</span>\n  </div>\n\n  <div class=\"content \">\n\n    <div class=\"chat ie-scroll other-scroll\" id='chat'>\n      <div class=\"chat-details pos-r\" >\n        <!-- 提示信息 -->\n        <div>\n          <p>商城客服工作时间为工作日的9:00~21:00</p>\n          <!-- <p>您好，请问有什么可以帮助您？</p> -->\n        </div>\n\n       <chat-content [chatList]=\"chatList\" (sendListen)=\"sendListen($event)\"></chat-content>\n\n        <!-- 客服 \n\n            <p class=\"dialog\">\n                    <span class=\"iconfont icon-yonghu3 text-lighter-base vb-before mr-1\"></span>\n                    <span class=\"chat-content  bg-light-base tleft pos-r\">\n                        <span class=\"chat-content-txt text-left client-content \"><img src=\"http://demo.cssmoban.com/cssthemes5/cpts_1383_cij/assets/images/slider_img1.png\" style=\"max-width:100%\"></span>\n                    </span>\n                </p>\n            <p class=\"dialog text-right\">\n                <span class=\"chat-content  bg-light-base tright pos-r mr-1 text-left\">\n                    <span>请问您现在停留在哪个页面，是在订单确认还是银联付款页面?请问您现在停留在哪个页面，是在订单确认还是银联付款页面</span>\n                </span>\n                <span class=\"iconfont icon-kefu text-lighter-base vb-before \"></span>\n            </p>\n            <p class=\"dialog text-right\">\n\n                <span class=\"chat-content  bg-light-base tright pos-r mr-1 text-left\">\n                    <span><img src=\"http://demo.cssmoban.com/cssthemes5/cpts_1383_cij/assets/images/slider_img1.png\" style=\"max-width:100%\"></span>\n                </span>\n                <span class=\"iconfont icon-kefu text-lighter-base vb-before \"></span>\n            </p>  \n            <p class=\"time\">2019/02/08 10:11:11</p>-->\n            <chat-unread [who]=\"this\" [unread]=\"unreadOption.unread\"></chat-unread>\n      </div>\n    </div>\n    <div class=\"edit-area\" id=\"edit\">\n      <edit-operate [who]=\"this\" (fileEmiter)=\"fileEmiter($event)\"></edit-operate>\n      <send-area   (sendListen)=\"sendListen($event)\" [keepEnd]=\"keepEnd\" [who]=\"this\"></send-area>\n    </div>\n  </div>\n</div>","import {\n  HttpClient,\n  HttpErrorResponse,\n  HttpEventType,\n  HttpRequest,\n  HttpResponse,\n} from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { throwError } from 'rxjs';\nimport { catchError } from 'rxjs/operators';\n@Injectable({\n  providedIn: 'root',\n})\nexport class ComService {\n  // 错误消息提示\n  alert: { msg: string; show: boolean } = { msg: '', show: false };\n  ws: any;\n  data: any = {};\n  previewOption: { isShowMask: boolean; src?: string } = {\n    isShowMask: false,\n  };\n\n  api = {\n    login: '/api/auth/login', //post\n    register: '/api/auth/register', //post\n    message: '/api/message/', //post\n    polling: '/api/message/polling', //get\n    history: '/api/message/record', //get\n    userList: '/api/user/list', // get\n    logout: '/api/auth/logout', //post\n    userInfo: '/api/user/', //{uid},get\n    files: '/file/', // 上传文件\n  };\n  isLogin: boolean = true;\n  constructor(private http: HttpClient, private router: Router) {\n    this.windowActive();\n  }\n  isWindowActive: boolean = true;\n  // 格式化时间\n  formatTime(\n    date: string | number | Date = '' /* 日期，可选默认今天 */,\n    fmt = 'YYYY-MM-DD' /*格式字符串默认YYYY-MM-DD hh:mm:ss */\n  ) {\n    //兼容ios\n    if (typeof date === 'string') {\n      date = date.replace(/-/g, '/');\n    }\n    date = date ? new Date(date) : new Date();\n    var o = {\n      'Y+': date.getFullYear(), //年\n      'M+': date.getMonth() + 1, //月份\n      'D+': date.getDate(), //日\n      'h+': date.getHours(), //小时\n      'm+': date.getMinutes(), //分\n      's+': date.getSeconds(), //秒\n      'q+': Math.floor((date.getMonth() + 3) / 3), //季度\n      S: date.getMilliseconds(), //毫秒\n    };\n    if (/(Y+)/.test(fmt)) {\n      fmt = fmt.replace(RegExp.$1, (o['Y+'] + '').substr(4 - RegExp.$1.length));\n    }\n    for (var k in o) {\n      if (new RegExp('(' + k + ')').test(fmt)) {\n        fmt = fmt.replace(\n          RegExp.$1,\n          RegExp.$1.length == 1\n            ? o[k]\n            : ('00' + o[k]).substr(('' + o[k]).length)\n        );\n      }\n    }\n    return fmt;\n  }\n  timeFromNow(time) {\n    //时间转换\n    const timestamp = Date.now();\n    const createTime = new Date(time);\n    time = createTime.getTime();\n    const diff = timestamp - time;\n    if (diff < 60 * 1000) {\n      return '';\n    } else if (diff < 60 * 60 * 1000) {\n      return Math.floor(diff / (60 * 1000)) + '分钟前';\n    } else if (diff < 24 * 60 * 60 * 1000) {\n      return Math.floor(diff / (60 * 60 * 1000)) + '小时前';\n    } else {\n      return this.formatTime(time, 'YYYY-MM-DD hh:mm');\n    }\n  }\n  windowActive() {\n    var hiddenProperty =\n      'hidden' in document\n        ? 'hidden'\n        : 'webkitHidden' in document\n        ? 'webkitHidden'\n        : 'mozHidden' in document\n        ? 'mozHidden'\n        : null;\n    var visibilityChangeEvent = hiddenProperty.replace(\n      /hidden/i,\n      'visibilitychange'\n    );\n    var onVisibilityChange = function () {\n      if (document[hiddenProperty]) {\n        // 未激活状态！-发送桌面通知\n        this.isWindowActive = true;\n      } else {\n        // '激活状态！\n        this.isWindowActive = false;\n      }\n    };\n    document.addEventListener(visibilityChangeEvent, onVisibilityChange);\n    window.onblur = () => {\n      this.isWindowActive = false;\n    };\n    window.onfocus = () => {\n      this.isWindowActive = true;\n    };\n  }\n  showAlert(msg) {\n    this.alert.show = true;\n    this.alert.msg = msg;\n    setTimeout(() => {\n      this.alert.show = false;\n    }, 2000);\n  }\n\n  doHttpResponse(res, success, fail?) {\n    let code = res.code;\n    if (code) {\n      if (code === 3 || code === 6) {\n        // 未登录\n        this.isLogin = false;\n        this.showAlert('登录失效，请重新登录');\n        setTimeout(() => {\n          this.router.navigate(['/auth/login']);\n        }, 2000);\n      } else {\n        fail ? fail(res) : this.showAlert(res.msg);\n      }\n    } else {\n      // 成功\n      success && success(res.data);\n    }\n  }\n  // 发送消息\n  sendMsg(msg, success?, fail?) {\n    this.http\n      .post(this.api.message, msg)\n      .pipe(\n        catchError(\n          this.handleError('sendMsg', () => {\n            fail && fail();\n          })\n        )\n      )\n      .subscribe((res) => {\n        this.doHttpResponse(\n          res,\n          (data) => {\n            success && success(data);\n          },\n          fail\n        );\n      });\n  }\n  private handleError(uri: string, failCallback?) {\n    return (error: HttpErrorResponse) => {\n      console.dir(error);\n      if (failCallback) {\n        setTimeout(() => {\n          failCallback();\n        }, 3000);\n      } else {\n        this.showAlert('http request ' + uri + ' error ');\n      }\n\n      if (error.error instanceof ErrorEvent) {\n        // A client-side or network error occurred. Handle it accordingly.\n        console.error(\n          'A client-side or network error occurred. Handle it accordingly.'\n        );\n        this.showAlert('网络错误');\n      } else {\n        // The backend returned an unsuccessful response code.\n        // The response body may contain clues as to what went wrong.\n        console.error(\n          `Backend returned code ${error.status}, ` + `body was: ${error.error}`\n        );\n        this.showAlert('后端服务器错误');\n      }\n      // Return an observable with a user-facing error message.\n      return throwError('Something bad happened; please try again later.');\n    };\n  }\n  // 开启轮询\n  pollingStart(obj, random: string, domain?: string) {\n    let options: any = {\n      observe: 'response',\n    };\n\n    this.http\n      .get(\n        this.api.polling + '?random=' + random + (domain ? '&' + domain : ''),\n        options\n      )\n      .pipe(\n        catchError(\n          this.handleError('polling', () => {\n            this.pollingStart(obj, random, domain);\n          })\n        )\n      )\n      .subscribe((res: any) => {\n        if (!obj.myID) {\n          obj.myID = Number(res.headers.get('Uid'));\n        }\n        // 新建立的连接，要渲染历史记录\n        let isNewConnect = res.headers.get('Request-Times') === '1';\n        let ret = res.body;\n        let isServer = 'rid' in obj;\n        this.doHttpResponse(ret, (data) => {\n          console.log('data: ', data);\n          if (isNewConnect) {\n            if (!isServer) {\n              data.forEach((d) => {\n                this.attachSPT(obj, d, isServer);\n              });\n\n              obj.chatList = data || [];\n              setTimeout(() => {\n                obj.toBottom();\n              }, 500);\n            }\n          } else {\n            // 渲染数据到聊天窗口\n            data && this.doPolling(data, obj, isServer);\n          }\n        });\n        // 获取到数据-直接轮询\n        this.isLogin && this.pollingStart(obj, random, domain);\n      });\n  }\n  // 图片预览\n  preview(file, callback) {\n    var reader = new FileReader();\n    reader.readAsDataURL(file);\n    reader.onload = (e) => {\n      callback(e.target.result);\n    };\n  }\n  // 上传文件\n  uploadFile(fileObj, callback, progressCallback?) {\n    const formData = new FormData();\n    formData.append('file', fileObj.file);\n    let api = 'https://io.imdraw.com:444';\n    const req = new HttpRequest('POST', api, formData, {\n      reportProgress: true,\n    });\n    this.http\n      .request(req)\n      .pipe(\n        catchError(\n          this.handleError('uploadFile', () => {\n            callback(fileObj, true);\n            this.showAlert('文件服务器故障!');\n          })\n        )\n      )\n      .subscribe((event) => {\n        if (event.type === HttpEventType.UploadProgress) {\n          fileObj.uploadProgress = Math.round(\n            (100 * event.loaded) / event.total\n          );\n          progressCallback && progressCallback(fileObj);\n        } else if (event instanceof HttpResponse) {\n          let body: any = event.body;\n          fileObj.src = api + '/' + body.key;\n          fileObj.type === 'file' && (fileObj.src += '?operation=download');\n          callback(fileObj);\n        }\n      });\n  }\n\n  debounce(fn, delay = 1000) {\n    var timeout;\n    return function () {\n      clearTimeout(timeout);\n      timeout = setTimeout(fn.bind(this, ...arguments), delay);\n    };\n  }\n  // fid 接收者=我 右， 不是我 左\n  /**\n   *\n   * @param data\n   * @param obj\n   * @param isServer\n   */\n  doPolling(data, obj, isServer?) {\n    console.log('doPolling: ', data);\n    data.forEach((d) => {\n      let fid = d.fid;\n      let isISend = fid === obj.myID;\n      let type = d.type;\n      switch(type){\n          // 普通消息\n        case 0:\n          this.doType0(isISend,obj,d,isServer)\n          break;\n          // 已读未读消息\n        case 1:\n          this.doType1(d, obj, isISend,isISend);\n          break;\n          // 上下线消息\n        case 3:\n          this.doType3(isISend, d, isServer, obj);\n          break;\n      }      \n    });\n    obj.toBottom();\n  }\n  // 处理已读未读消息\n  doType1(d, obj, isISend,isServer) {\n    // 已读未读消息\n    if (!isISend) {\n      if (isServer) {\n        // 服务端\n        // 发来的是自己吗-是的话就不用改变-不是就要判断\n        if(!isISend){\n          // 判断发来的是当前用户吗\n          let isCuUserSend =obj.user.id === d.fid;\n          if(isCuUserSend){\n            // 当前用户发来的设置已读\n            let i = obj.chatList.findIndex(x=>x.id === d.id);\n            i>-1 && (obj.chatList[i].readed = true)\n          }else{\n            // 判断发来的是在用户列表的用户吗\n            let isUserInList = obj.userList.findIndex(x=>x.id === d.fid)>-1\n            if(isUserInList){\n              // 是列表中的用户发来的已读消息-不用处理\n              console.log('是列表中的用户发来的已读消息-不用处理: ');\n            }else{\n              // 不是列表总的用户发来的-用户入用户列表？不处理-看是否有这个用户\n              console.log('不是列表总的用户发来的-用户入用户列表？不处理-看是否有这个用户: ');\n            }\n          }\n        }\n      } else {\n        // 客户端\n        let i = obj.chatList.findeIndex((x) => x.id === d.id);\n        i > -1 && (obj.chatList[i].readed = true);\n      }\n    }\n  }\n  // 处理上下限消息\n  doType3(isISend, d, isServer, obj) {\n    isISend &&\n      this.showAlert(\n        '游客' + d.fid + (d.data === 'online' ? '上' : '离') + '线'\n      );\n    // 客服端 处理一下用户列表用户上下线显示\n    if (isServer) {\n      let i = obj.userList.findIndex((x) => x.id === d.fid);\n\n      i > -1 && (obj.userList[i].state = d.data === 'online');\n      console.log('type=3', i, d, obj.userList[i].state);\n    }\n  }\n  // 处理普通消息\n  doType0(isISend,obj,d,isServer) {\n    let fid = d.fid;\n    this.attachSPT(obj, d, isServer);\n    if (!isISend) {\n      // 不是我发送的消息-判断是客服端还是服务端\n      let chatScrollTop = obj.chatElem.scrollTop;\n      if (isServer) {\n        // 客服端-判断发送方是正在谈话的一方吗\n        let isCuUserSend = fid === (obj.user && obj.user.id);\n        d.state = true;\n        if (isCuUserSend) {\n          obj.chatList.push(d);\n          let name =\n            obj.user && obj.user.name\n              ? '用户' + obj.user.name\n              : '游客' + fid;\n          !this.isWindowActive &&\n            this.deskNotify('消息提示', name + '发来一条新消息');\n            \n            if(this.isWindowActive){\n              // 当前用户激活窗口\n              if(chatScrollTop===0){\n                // 直接发送已读消息\n                this.sendMsg({id:d.id,rid:obj.user.id,type:1})\n              }else{\n                // 有滚动条-直接设置未读已读\n                obj.user.unreadOption = obj.user.unreadOption ||{};\n                obj.user.unreadOption.unread ++;\n                obj.user.unreadOption.scrollHeight = obj.chatElem.scrollHeight;\n              }\n            }else{\n               // 未激活-直接设置未读已读\n               obj.user.unreadOption = obj.user.unreadOption ||{};\n               obj.user.unreadOption.unread ++;\n               obj.user.unreadOption.scrollHeight = obj.chatElem.scrollHeight;\n            }\n\n        } else {\n          // 不是当前用户发来的消息-判断该用户是否已经在用户列表了\n          let userIndex = obj.userList.findIndex((u) => u.id === fid);\n          let isInUserList = userIndex > -1;\n          if (isInUserList) {\n            let name =\n              obj.userList[userIndex] && obj.userList[userIndex].name\n                ? '用户' + obj.userList[userIndex].name\n                : '游客' + fid;\n            this.deskNotify('消息提示', name + '发来一条新消息');\n            obj.userList[userIndex].unreadOption = obj.userList[userIndex].unreadOption || {};\n                obj.user.unreadOption.unread ++;\n                obj.user.unreadOption.scrollHeight = obj.chatElem.scrollHeight;\n\n          } else {\n            // 不在用户列表-获取用户信息-推送用户到列表\n\n            this.getUserInfo(fid, (userInfo) => {\n              obj.userList.unshift(userInfo);\n              let name = userInfo.name\n                ? '用户' + userInfo.name\n                : '游客' + fid;\n              d.state = true;\n              !this.isWindowActive &&\n                this.deskNotify('消息提示', name + '发来一条新消息');\n               userInfo.unreadOption = userInfo.unreadOption || {};\n               userInfo.unreadOption.unread ++;\n               userInfo.unreadOption.scrollHeight = obj.chatElem.scrollHeight;\n            });\n          }\n        }\n      } else {\n        // 客户端-显示在左侧\n        obj.chatList.push(d);\n        !this.isWindowActive &&\n          this.deskNotify('消息提示', '有一条新消息回复');\n        // 给加未读和设置已读消息\n        \n        if(this.isWindowActive){\n          // 窗口激活\n          if(chatScrollTop === 0){\n            // 窗口没有滚动条-直接阅读了消息-发送已阅读消息\n            this.sendMsg({id:d.id,type:1})\n            d.readed = true;\n          }else{\n            // 有滚动条- 设置未读消息数\n            obj.unreadOption.unread ++;\n            obj.unreadOption.scrollHeight = obj.chatElem.scrollHeight\n          }\n        }else{\n          // 窗口未激活-增加未读\n          obj.unreadOption.unread ++;\n          obj.unreadOption.scrollHeight = obj.chatElem.scrollHeight\n        }\n      }\n    } else {\n      // 是我发送的，先看在不在列表中，不在的话就推到列表中      \n      let i = obj.chatList.findIndex((x) => x.mark === d.mark);\n      i === -1 && obj.chatList.push(d);\n    }\n  }\n  // 处理历史消息\n  doHistory(data,isServer){\n    // 设置未读数-和对方一堆信息标志\n    // 客户端 判断最后一条消息是不是客户消息，是的话默认全部客服unreadOption.unread=0,否则看最后一条消息是不是两个读者，是的话就是chatList[len-1]:unread\n    let lastMsg = data[data.length-1];\n    console.log('lastMsg: ', lastMsg);\n    data.foreach(el=>{\n      if(isServer){\n\n      }else{\n        // 客户端\n        \n      }\n    })\n  }\n  // 获取用户列表\n  getUserList(success) {\n    this.http\n      .get(this.api.userList)\n      .pipe(catchError(this.handleError('getUserList')))\n      .subscribe((res) => {\n        this.doHttpResponse(res, success);\n      });\n  }\n  getUserInfo(id, cb) {\n    this.http\n      .get(this.api.userInfo + id)\n      .pipe(catchError(this.handleError('getUserInfo')))\n      .subscribe((res: any) => {\n        this.doHttpResponse(res, cb);\n      });\n  }\n  login(data) {\n    this.http\n      .post(this.api.login, data)\n      .pipe(catchError(this.handleError('login')))\n      .subscribe((res) => {\n        this.doHttpResponse(res, () => {\n          this.showAlert('登录成功');\n          this.isLogin = true;\n          // 登录成功跳转客服页面\n          setTimeout(() => {\n            this.router.navigate(['/server']);\n          }, 2000);\n        });\n      });\n  }\n  register(data) {\n    this.http\n      .post(this.api.register, data)\n      .pipe(catchError(this.handleError('register')))\n      .subscribe((res) => {\n        this.doHttpResponse(res, () => {\n          this.showAlert('注册成功，马上跳转登录');\n          setTimeout(() => {\n            this.router.navigate(['/auth/login']);\n          }, 2000);\n        });\n      });\n  }\n\n  logout() {\n    this.http\n      .post(this.api.logout, null)\n      .pipe(catchError(this.handleError('logout')))\n      .subscribe((res) => {\n        this.doHttpResponse(res, () => {\n          this.showAlert('登出成功!');\n          setTimeout(() => {\n            this.router.navigate(['/auth/login']);\n          }, 2000);\n        });\n      });\n  }\n  getHistory(obj, id, success) {\n    let options: any = {\n      observe: obj.myID ? 'body' : 'response',\n    };\n    let isResponseObserv = options.observe === 'response';\n    let isServer = 'rid' in obj;\n    this.http\n      .get(this.api.history + (id ? '?id=' + id : ''), options)\n      .pipe(catchError(this.handleError('getHistory')))\n      .subscribe((res: any) => {\n        if (!obj.myID && isResponseObserv) {\n          obj.myID = Number(res.headers.get('Uid'));\n        }\n        let ret = isResponseObserv ? res.body : res;\n        this.doHttpResponse(ret, (data) => {\n          data && data.reverse();\n          data &&\n            data.forEach((d) => {\n              this.attachSPT(obj, d, isServer);\n            });\n\n          success(data);\n        });\n      });\n  }\n\n  attachSPT(obj, d, isServer) {\n    let isIsend = d.fid === obj.myID;\n\n    d.isServer = isServer ? isIsend : !isIsend;\n    d.position = !isIsend;\n    d.timeStr = this.timeFromNow(d.time / 1000000);\n    d.timeFormat = this.formatTime(d.time / 1000000, 'YYYY-MM-DD hh:mm:ss');\n  }\n  timer: any;\n  notifyInstanceEvent(instance) {\n    instance.onclick = function (e) {\n      console.log('click: ', e);\n      window.focus();\n      instance.close();\n    };\n    instance.onerror = function () {};\n    instance.onshow = function () {};\n    instance.onclose = function () {};\n  }\n  deskNotify(title, msg) {\n    let img = '/assets/images/desk-logo.png';\n    var Notification = window.Notification;\n\n    if (Notification) {\n      //支持桌面通知\n      if (Notification.permission == 'granted') {\n        //已经允许通知\n        var instance = new Notification(title, {\n          body: msg,\n          icon: img,\n          data: 'localhost/server',\n        });\n        this.notifyInstanceEvent(instance);\n      } else {\n        //第一次询问或已经禁止通知(如果用户之前已经禁止显示通知，那么浏览器不会再次询问用户的意见，Notification.requestPermission()方法无效)\n        Notification.requestPermission(function (status) {\n          if (status === 'granted') {\n            //用户允许\n            var instance = new Notification(title, {\n              body: msg,\n              icon: img,\n            });\n            this.notifyInstanceEvent(instance);\n          } else {\n            //用户禁止\n            return false;\n          }\n        });\n      }\n    } else {\n      //不支持(IE等)\n      var index = 0;\n      clearInterval(this.timer);\n      this.timer = setInterval(function () {\n        let titleElem = document.getElementsByName('title')[0];\n        if (index % 2) {\n          titleElem.innerText = '【　　　】' + title; //这里是中文全角空格，其他不行\n        } else {\n          titleElem.innerText = '【新消息】' + title;\n        }\n        index++;\n\n        if (index > 20) {\n          clearInterval(this.timer);\n        }\n      }, 500);\n    }\n  }\n}\n","import { Pipe, PipeTransform } from '@angular/core';\nimport { DomSanitizer } from '@angular/platform-browser';\n\n@Pipe({\n  name: 'toSafe'\n})\nexport class ToSafePipe implements PipeTransform {\n  constructor(\n    private _sanitizer: DomSanitizer\n  ) { }\n  // args={url,html,}\n  transform(value: any, args?: any): any {\n    args = args || 'url';\n    return  this._sanitizer['bypassSecurityTrust'+ args[0].toUpperCase()+args.slice(1)](value);\n  }\n\n}\n","import { Component, OnInit } from '@angular/core';\n\n@Component({\n  selector: 'app-manage',\n  templateUrl: './manage.component.html',\n  styleUrls: ['./manage.component.css']\n})\nexport class ManageComponent implements OnInit {\n\n  constructor() { }\n  serverUrl :string = \"http://localhost:4200/server\";\n  tabIndex :number = 0;\n  ngOnInit(): void {\n  }\n  changeTab(e){\n    console.dir(e.target)\n    let i  = Number(e.target.dataset.index);\n    !isNaN(i) && ( this.tabIndex = i);\n  }\n\n}\n","<div class=\"container clearfix\">\n    <div class=\"title bg-base noselect\" ondragstart=\"return false\" id=\"nameTitle\">\n        <img src=\"assets/images/logo.png\" class=\"vm\">\n        <span>在线客服</span>\n        <p class='fr name'>\n            <span>管理员01</span>\n            <span class=\"iconfont icon-true online\"></span>\n            <span class=\"state-txt\">在线</span>\n        </p>\n    </div>\n    <!-- 内容区 -->\n    <div class=\"content clearfix\" id=\"contentBox\">\n\n        <!-- 左侧客户列表 -->\n        <div class=\"fl left ie-scroll other-scroll \">\n            <div class=\"menu\">\n                <span class=\"iconfont icon-menu\" id=\"menu\"></span>\n            </div>\n            <ul id=\"customers\" class=\"customers\" (click)=\"changeTab($event)\">\n                <li [class]=\"tabIndex===0?'active':''\" data-index=\"0\" >客户管理</li>\n                <li data-index=\"1\" [class]=\"tabIndex===1?'active':''\">客服管理</li>\n                <li data-index=\"2\" [class]=\"tabIndex===2?'active':''\">聊天窗口</li>\n            </ul>\n\n        </div>\n\n\n        <!-- 右侧-->\n        <div class=\"fr right pos-r\" id=\"history\">\n\n            <h2 class=\"\"><span class=\"vm\">消息记录</span> <i\n                    class=\"iconfont text-base icon-close vm-before fr mr-1  csr\" id=\"lisi\"></i></h2>\n            <div class=\"history-content ie-scroll other-scroll\" >\n                <!-- 昨天有聊天的时间 hh:mm:ss 显示每条记录的时间客户 -->\n                <!-- 客户 \n                <div class=\"dialog-r\">\n                    <p class=\"text-base\"><span>1345...4564</span> <span>12:34:12</span></p>\n                    <p class=\"ml-1\">聊天内容聊天内容聊天内容聊天内容聊天内容聊天内容聊天内容聊天内容聊天内容聊天内容</p>\n                </div>-->\n                <!-- 客服 \n                <div class=\"dialog-r\">\n                    <p class=\"online\"><span>客服001</span> <span>12:34:15</span></p>\n                    <p class=\"ml-1\">聊天内容聊天内容</p>\n                </div>-->\n\n\n<!-- \n\n\n\n\n\n                <div class=\"dialog-r\">\n                    <p class=\"text-base\"><span>1345...4564</span> <span>12:34:12</span></p>\n                    <p class=\"ml-1\">聊天内容聊天内容聊天内容聊天内容聊天内容聊天内容聊天内容聊天内容聊天内容聊天内容</p>\n                </div>\n                <div class=\"dialog-r\">\n                    <p class=\"text-base\"><span>1345...4564</span> <span>12:34:12</span></p>\n                    <p class=\"ml-1\">聊天内容聊天内容聊天内容聊天内容聊天内容聊天内容聊天内容聊天内容聊天内容聊天内容</p>\n                </div>\n                <div class=\"dialog-r\">\n                    <p class=\"text-base\"><span>1345...4564</span> <span>12:34:12</span></p>\n                    <p class=\"ml-1\">聊天内容聊天内容聊天内容聊天内容聊天内容聊天内容聊天内容聊天内容聊天内容聊天内容</p>\n                </div>\n                <div class=\"dialog-r\">\n                    <p class=\"text-base\"><span>1345...4564</span> <span>12:34:12</span></p>\n                    <p class=\"ml-1\">聊天内容聊天内容聊天内容聊天内容聊天内容聊天内容聊天内容聊天内容聊天内容聊天内容</p>\n                </div>\n                <div class=\"dialog-r\">\n                    <p class=\"text-base\"><span>1345...4564</span> <span>12:34:12</span></p>\n                    <p class=\"ml-1\">聊天内容聊天内容聊天内容聊天内容聊天内容聊天内容聊天内容聊天内容聊天内容聊天内容</p>\n                </div>\n                <div class=\"dialog-r\">\n                    <p class=\"text-base\"><span>1345...4564</span> <span>12:34:12</span></p>\n                    <p class=\"ml-1\">聊天内容聊天内容聊天内容聊天内容聊天内容聊天内容聊天内容聊天内容聊天内容聊天内容</p>\n                </div>\n                <div class=\"dialog-r\">\n                    <p class=\"text-base\"><span>1345...4564</span> <span>12:34:12</span></p>\n                    <p class=\"ml-1\">聊天内容聊天内容聊天内容聊天内容聊天内容聊天内容聊天内容聊天内容聊天内容聊天内容</p>\n                </div>\n                <div class=\"dialog-r\">\n                    <p class=\"text-base\"><span>1345...4564</span> <span>12:34:12</span></p>\n                    <p class=\"ml-1\">聊天内容聊天内容聊天内容聊天内容聊天内容聊天内容聊天内容聊天内容聊天内容聊天内容</p>\n                </div>\n                <div class=\"dialog-r\">\n                    <p class=\"text-base\"><span>1345...4564</span> <span>12:34:12</span></p>\n                    <p class=\"ml-1\">聊天内容聊天内容聊天内容聊天内容聊天内容聊天内容聊天内容聊天内容聊天内容聊天内容</p>\n                </div> -->\n\n\n\n\n            </div>\n            <!-- 日历 -->\n            <div  >\n                <!-- 接入css -->\n                <div class=\"d-none pos-a calendar\" id=\"calendar\">\n                    <div id='schedule-box' class=\"boxshaw\">\n                    </div>\n                    <div>\n\n                    </div>\n                </div>\n                <div class=\"fixed-calendar boxshaw \" id=\"rili\">\n                    <span class=\"ml-1 csr\">\n                        <i class=\"iconfont icon-calendar text-base vm\" id=\"kanRili\"></i>\n                        <span id='riliTxt' class=\"vm\">2012-5-1</span>\n                    </span>\n\n                    <span class=\"history-op fr mr-1\">\n                        <i class=\"iconfont icon-left-stop bold\" title=\"第一页\"></i>\n                        <i class=\"iconfont icon-less-than\" title=\"上一页\"></i>\n                        <i class=\"iconfont icon-great-than\" title=\"下一页\"></i>\n                        <i class=\"iconfont icon-right-stop bold\" title=\"最后一页\"></i>\n                    </span>\n                </div>\n\n            </div>\n\n        </div>\n\n        <!-- 中/右侧聊天框 -->\n        <div class=\"center\" id=\"center\">\n            <!-- 客户管理 -->\n            <div class=\"customer-list ie-scroll other-scroll\" [class]=\"tabIndex===0?'':'d-none'\">\n                <table>\n                    <thead>\n                        <tr>\n                            <th class=\"th-tag\"></th>\n                            <th>访客姓名</th>\n                            <th>访问次数</th>\n                            <th>地区</th>\n                            <th class=\"d-sm-none\">停留时间</th>\n                            <th class=\"d-sm-none\">最后活动</th>\n                            <th>IP地址</th>\n                            <th>当前接待</th>\n                            <th>操作</th>\n                        </tr>\n                    </thead>\n                    <tbody id=\"tbContent\">\n                        <tr>\n                            <td class=\"th-tag\"><span class=\"icon new\">新</span></td>\n                            <td>秦某某</td>\n                            <td>03</td>\n                            <td>河北省</td>\n                            <td class=\"d-sm-none\">00:00:37</td>\n                            <td class=\"d-sm-none\">00:00:37</td>\n                            <td>127.0.0.1</td>\n                            <td>客服01</td>\n                            <td class=\"pos-r\">\n                                <i class=\"iconfont icon-search\"></i>\n                                <ul class=\"pos-a search-menu\">\n                                    <li class=\"active\">聊天记录</li>\n                                    <li>历史轨迹</li>\n                                </ul>\n                            </td>\n                        </tr>\n\n                        <tr>\n                            <td class=\"th-tag\"><span class=\"icon new\">新</span></td>\n                            <td>秦某某</td>\n                            <td>03</td>\n                            <td>河北省</td>\n                            <td class=\"d-sm-none\">00:00:37</td>\n                            <td class=\"d-sm-none\">00:00:37</td>\n                            <td>127.0.0.1</td>\n                            <td>客服01</td>\n                            <td>\n                                <i class=\"iconfont icon-search\"></i>\n\n                            </td>\n                        </tr>\n                    </tbody>\n                </table>\n\n                <!-- 页码 -->\n                <ul id=\"pagenation\" class=\"page\"></ul>\n            </div>\n\n            <!-- 客服管理 -->\n            <div class=\"customer-list server-manage ie-scrollother-scroll\" [class]=\"tabIndex===1?'':'d-none'\">\n                <h3>所有客服</h3>\n                <ul>\n                    \n                    <li >\n                        <div class=\"name-online\">\n                            <div class=\"d-inline-block\">\n                                <span class=\"icon-container d-inline-block\"><i class=\"iconfont icon-server\"></i></span>\n                                <span>客服001</span>\n                            </div>\n                            <div class=\"online-info fr \">\n                                <span class=\"circle\"></span>\n                                <span>在线</span>\n                            </div>\n                           \n                        </div>\n\n                        <div>\n                            <div class=\"dialog-info d-inline-block\">\n                                <div class=\"text-right\">\n                                    <span class=\"fl mr-1\">当前对话</span>\n                                    <span class=\"dialog-txt\">4</span>\n                                </div>\n                                <div class=\"text-right\">\n                                    <span class=\"fl mr-1\">今日对话</span>\n                                    <span class=\"dialog-txt\">15</span>\n                                </div>\n                            </div>\n                             \n                                <button class=\"fr btn-dialog\" data-id=\"1\">对话记录</button>\n                           \n                        </div>\n                    </li>\n\n                    <li >\n                        <div class=\"name-online\">\n                            <div class=\"d-inline-block\">\n                                <span class=\"icon-container d-inline-block\"><i class=\"iconfont icon-server\"></i></span>\n                                <span>客服001</span>\n                            </div>\n                            <div class=\"online-info fr \">\n                                <span class=\"circle\"></span>\n                                <span>在线</span>\n                            </div>\n                           \n                        </div>\n\n                        <div>\n                            <div class=\"dialog-info d-inline-block\">\n                                <div class=\"text-right\">\n                                    <span class=\"fl mr-1\">当前对话</span>\n                                    <span class=\"dialog-txt\">4</span>\n                                </div>\n                                <div class=\"text-right\">\n                                    <span class=\"fl mr-1\">今日对话</span>\n                                    <span class=\"dialog-txt\">15</span>\n                                </div>\n                            </div>\n                             \n                                <button class=\"fr btn-dialog\"  data-id=\"2\">对话记录</button>\n                           \n                        </div>\n                    </li>\n\n                    <li >\n                        <div class=\"name-online\">\n                            <div class=\"d-inline-block\">\n                                <span class=\"icon-container d-inline-block\"><i class=\"iconfont icon-server\"></i></span>\n                                <span>客服001</span>\n                            </div>\n                            <div class=\"online-info fr \">\n                                <span class=\"circle\"></span>\n                                <span>在线</span>\n                            </div>\n                           \n                        </div>\n\n                        <div>\n                            <div class=\"dialog-info d-inline-block\">\n                                <div class=\"text-right\">\n                                    <span class=\"fl mr-1\">当前对话</span>\n                                    <span class=\"dialog-txt\">4</span>\n                                </div>\n                                <div class=\"text-right\">\n                                    <span class=\"fl mr-1\">今日对话</span>\n                                    <span class=\"dialog-txt\">15</span>\n                                </div>\n                            </div>\n                             \n                                <button class=\"fr btn-dialog\"  data-id=\"3\">对话记录</button>\n                           \n                        </div>\n                    </li>\n                </ul>\n                \n                 \n            </div>\n            <div class=\"customer-list ie-scroll other-scroll  \" [class]=\"tabIndex===2?'':'d-none'\">\n                <iframe  frameborder=0 style=\"width:100%;height:100%\"  src=\"http://localhost:4200/server\"></iframe>\n            </div>\n\n        </div>\n\n    </div>\n\n</div>\n\n\n<div class=\"alert d-none\" id=\"alert\">错误提示</div>","import { Component, OnInit } from '@angular/core';\nimport { ActivatedRoute, Params } from '@angular/router';\nimport { ComService } from '../core/com.service';\nimport * as Canlendar from '../../assets/js/calendar';\n\n@Component({\n  selector: 'app-server',\n  templateUrl: './server.component.html',\n  styleUrls: ['./server.component.css'],\n})\nexport class ServerComponent implements OnInit {\n  chatList: any = [];\n  ws: any;\n  rid: any = 0;\n  // 当前用户\n  user: any;\n  // 用户列表\n  userList = [];\n  // 我的id\n  myID: number;\n  rightShow: string = '';\n  chatElem: any;\n  stateMenuShow: boolean = false;\n  allHistory: any = [];\n  rightHistory: any[] = [];\n  // 文件列表\n  files: any = [];\n  // 当前添加的文件/图片\n  // 是否显示用户列表\n  isShowUserList: boolean = false;\n  // 历史记录日历显示\n  historyDate: string = '';\n  // 是否显示月日历\n  isShowMonthCalendar: boolean = false;\n  constructor(private com: ComService, private route: ActivatedRoute) {}\n\n  ngOnInit(): void {\n    this.historyDate = this.com.formatTime('', 'YYYY-MM-DD');\n    this.initCalendar();\n    this.chatElem = document.getElementById('chat');\n    this.com.getUserList((data) => {\n      console.log('com.getUserList data: ', data);\n      if (data && data.length) {\n        data.forEach(d => {\n          // 5s不回应默认已掉线\n          d.state = Date.now() - d.note_at/1000000  < 5000\n        });\n        this.userList = data;\n        this.user = data[0];\n        this.getHistory();\n      }\n    });\n    // 开启轮询\n    let random = Date.now().toString();\n    this.com.pollingStart(this, random, 'role=1');\n  }\n  clickImg(e){\n    if(e.target.tagName.toLowerCase()==='img'){\n      this.com.previewOption.isShowMask = true;\n      this.com.previewOption.src = e.target.src;\n    }\n  }\n  initCalendar() {\n    let callback = (y, m, d) => {\n      this.historyDate = this.com.formatTime(\n        y + '-' + m + '-' + d,\n        'YYYY-MM-DD'\n      );\n    };\n    new Canlendar({\n      el: '#schedule-box',\n      clickCb: callback,\n      nextMonthCb: callback,\n      nextYeayCb: callback,\n      prevMonthCb: callback,\n      prevYearCb: callback,\n    });\n  }\n  keepEnd:boolean = false;\n  fileEmiter(e){\n    this.keepEnd = true;\n  }\n  // 历史记录按日期分离\n  getSpecialHistory(date) {\n    if (this.allHistory.length) {\n      this.rightHistory = this.allHistory.filter((el) => {\n        return el.timeFormat.indexOf(date) > -1;\n      });\n      this.isShowMonthCalendar = false;\n    }\n  }\n  showUserList() {\n    this.isShowUserList = !this.isShowUserList;\n  }\n  // 左侧切换用户\n  changeUser(i) {\n    \n    this.user = this.userList[i];\n    this.getHistory();\n  }\n  getHistory() {\n    this.com.getHistory(this, this.user.id, (data) => {\n      this.chatList = data || [];\n      setTimeout(()=>{\n      this.toBottom();\n    },1000)\n      if (this.rightShow) {\n        this.rightHistory = data;\n        this.allHistory = data;\n      }\n    });\n  }\n  toBottom() {\n    this.chatElem.scrollTop = this.chatElem.scrollHeight;\n  }\n  logout() {\n    // 登出\n    this.com.logout();\n    this.com.isLogin = false;\n  }\n   \n catchTab(e,callback){\n   callback && callback()\n   e.stopPropagation();\n }\n  showStateMenu() {\n    this.stateMenuShow = true;\n  }\n  hideShowing() {\n    this.stateMenuShow = false;\n    this.isShowUserList = false;\n    this.isShowMonthCalendar = false;\n  }\n  imgSrc: string = '';\n \n  rightHitoryShow(toggle) {  \n    if (!toggle) {\n      this.com.getHistory(this, this.user.id, (data) => {\n        // 显示右侧信息\n        this.rightShow = 'right-show';\n        this.rightHistory = data;\n        this.allHistory = data;\n      });\n    } else {\n      this.closeHistory();\n    }\n  }\n  closeHistory() {\n    \n    this.rightHistory = [];\n    this.rightShow = '';\n  }\n  showMonthCalendar() {\n    this.isShowMonthCalendar = !this.isShowMonthCalendar;\n  }\n  chooseDateConfirm() {\n    this.getSpecialHistory(this.historyDate);\n  }\n}\n","<div class=\"container clearfix\" >\n  <div class=\"title bg-base noselect pos-r\" ondragstart=\"return false\" id=\"nameTitle\">\n    <img src=\"assets/images/logo.png\" class=\"vm\">\n    <span>在线客服</span>\n    <div class='fr name  '>\n      <span class=\"mr-1\">客服{{myID}}</span>\n      <div class=\"d-inline-block\" (click)=\"showStateMenu();\">\n        <span class=\"iconfont icon-true online\"></span>\n        <span class=\"state-txt\">在线</span>\n        <i class=\"iconfont icon-dropdown\"></i>\n      </div>\n      <ul class=\"state-menu pos-a\" [class]=\"stateMenuShow?'show':''\">\n        <li class=\"active\">在线</li>\n        <li (click)=\"logout();\">登出</li>\n      </ul>\n    </div>\n\n  </div>\n  <!-- 内容区 -->\n  <div class=\"content clearfix\" [class]=\"rightShow\">\n\n    <!-- 左侧客户列表 -->\n    <div class=\"fl left ie-scroll other-scroll text-center \" [class]=\"isShowUserList?'pos-r':''\" >\n      <div class=\"menu \" (click)=\"showUserList();\">\n        <span class=\"iconfont icon-menu\" id=\"menu\"></span>\n      </div>\n      <div id=\"customers\" class=\"customers w-100 h-100 ie-scroll other-scroll \" [class]=\"isShowUserList?'show-list':''\">\n        <table class=\"user-list\" >\n          <tr [class]=\"user.id===u.id?'active':''\" *ngFor=\"let u of userList ;let i = index\" (click)=\"changeUser(i);\">\n            <td><span class=\"icon\" [class]=\"u.state?'new':'old'\" [title]=\"(u.state?'在':'离')+'线'\">{{u.state?'在':'离'}}</span></td>\n            <td>{{u.name||'游客'+u.id}}</td>\n            <td class=\"pos-r\">{{u.mall||'未知来源'}}<span *ngIf=\"u.unread\" class=\"unread-label pos-a\">110</span></td>\n          </tr>\n          <!-- <tr>\n                        <td><span class=\"icon new\">新</span></td>\n                        <td>15176367173</td>\n                        <td>广西桂林</td>\n                    </tr> -->\n          <tr *ngIf=\"!userList.length\">\n            <td colspan=\"3\">没有客户访问</td>\n          </tr>\n        </table>\n      </div>\n\n    </div>\n\n\n    <!-- -->\n    <div class=\"fr right\" id=\"history\">\n\n      <h2 class=\"\">\n        <span class=\"vm\">消息记录</span>\n        <i class=\"iconfont text-base icon-close vm-before fr mr-1  csr\" id=\"lisi\" (click)=\"closeHistory()\"></i>\n      </h2>\n      <div class=\"history-content ie-scroll other-scroll\">\n        <!-- 昨天有聊天的时间 hh:mm:ss 显示每条记录的时间客户 -->\n        <!-- 客户 -->\n        <div class=\"dialog-r\" *ngFor=\"let h of rightHistory\" (click)=\"clickImg($event)\">\n          <p [class]=\"h.isServer?'online':'text-base' \">\n            <span>{{h.isServer?'客服'+h.fid:h.name||'游客'+h.fid}}</span>\n            <span class=\"ml-1\">{{h.timeFormat}}</span>\n          </p>\n          <p class=\"ml-1\" [innerHTML]=\"h.data\"> </p>\n        </div>\n        <div class=\"dialog-r\" *ngIf=\"!rightHistory.length\">没有历史记录</div>\n        <!-- 客服 \n        <div class=\"dialog-r\">\n          <p class=\"online\"><span>客服001</span> <span>12:34:15</span></p>\n          <p class=\"ml-1\">聊天内容聊天内容</p>\n        </div>\n\n\n\n\n\n\n\n\n        <div class=\"dialog-r\">\n          <p class=\"text-base\"><span>1345...4564</span> <span>12:34:12</span></p>\n          <p class=\"ml-1\">聊天内容聊天内容聊天内容聊天内容聊天内容聊天内容聊天内容聊天内容聊天内容聊天内容</p>\n        </div>\n        <div class=\"dialog-r\">\n          <p class=\"text-base\"><span>1345...4564</span> <span>12:34:12</span></p>\n          <p class=\"ml-1\">聊天内容聊天内容聊天内容聊天内容聊天内容聊天内容聊天内容聊天内容聊天内容聊天内容</p>\n        </div>\n        <div class=\"dialog-r\">\n          <p class=\"text-base\"><span>1345...4564</span> <span>12:34:12</span></p>\n          <p class=\"ml-1\">聊天内容聊天内容聊天内容聊天内容聊天内容聊天内容聊天内容聊天内容聊天内容聊天内容</p>\n        </div>\n        <div class=\"dialog-r\">\n          <p class=\"text-base\"><span>1345...4564</span> <span>12:34:12</span></p>\n          <p class=\"ml-1\">聊天内容聊天内容聊天内容聊天内容聊天内容聊天内容聊天内容聊天内容聊天内容聊天内容</p>\n        </div>\n        <div class=\"dialog-r\">\n          <p class=\"text-base\"><span>1345...4564</span> <span>12:34:12</span></p>\n          <p class=\"ml-1\">聊天内容聊天内容聊天内容聊天内容聊天内容聊天内容聊天内容聊天内容聊天内容聊天内容</p>\n        </div>\n        <div class=\"dialog-r\">\n          <p class=\"text-base\"><span>1345...4564</span> <span>12:34:12</span></p>\n          <p class=\"ml-1\">聊天内容聊天内容聊天内容聊天内容聊天内容聊天内容聊天内容聊天内容聊天内容聊天内容</p>\n        </div>\n        <div class=\"dialog-r\">\n          <p class=\"text-base\"><span>1345...4564</span> <span>12:34:12</span></p>\n          <p class=\"ml-1\">聊天内容聊天内容聊天内容聊天内容聊天内容聊天内容聊天内容聊天内容聊天内容聊天内容</p>\n        </div>\n        <div class=\"dialog-r\">\n          <p class=\"text-base\"><span>1345...4564</span> <span>12:34:12</span></p>\n          <p class=\"ml-1\">聊天内容聊天内容聊天内容聊天内容聊天内容聊天内容聊天内容聊天内容聊天内容聊天内容</p>\n        </div>\n        <div class=\"dialog-r\">\n          <p class=\"text-base\"><span>1345...4564</span> <span>12:34:12</span></p>\n          <p class=\"ml-1\">聊天内容聊天内容聊天内容聊天内容聊天内容聊天内容聊天内容聊天内容聊天内容聊天内容</p>\n        </div>\n\n\n-->\n\n      </div>\n      <!-- 日历 -->\n      <div class=\"pos-r\">\n        <!-- 接入css -->\n        <div class=\" pos-a calendar\" [class]=\"isShowMonthCalendar?'':'d-none'\">\n          <div id='schedule-box' class=\"boxshaw\">\n          </div>\n          <div>\n\n          </div>\n        </div>\n        <div class=\"fixed-calendar boxshaw \" id=\"rili\">\n          <span class=\"ml-1 csr\" (click)=\"showMonthCalendar();\">\n            <i class=\"iconfont icon-calendar text-base vm\" id=\"kanRili\"></i>\n            <span id='riliTxt' class=\"vm\">{{historyDate}}</span>\n          </span>\n\n          <!-- <span class=\"history-op fr mr-1\" *ngIf=\"!isShowMonthCalendar\">\n            <i class=\"iconfont icon-left-stop bold\" title=\"上个月\"></i>\n            <i class=\"iconfont icon-less-than\" title=\"前一天\"></i>\n            <i class=\"iconfont icon-great-than\" title=\"下一天\"></i>\n            <i class=\"iconfont icon-right-stop bold\" title=\"下个月\"></i>\n          </span> -->\n          <button *ngIf=\"isShowMonthCalendar\" class=\"confirm-btn fr\" (click)=\" getSpecialHistory( historyDate); \"> 确定\n          </button>\n        </div>\n\n      </div>\n\n    </div>\n\n    <!-- 中/右侧聊天框 -->\n    <div class=\"center pos-r\" id=\"center\">\n      <div class=\"user-info pos-a\" *ngIf=\"user\">\n        <!-- <div id=\"user\"><i class=\"ml-1 iconfont icon-user text-lighter-base vm\" id=\"userIcon\"></i> <span\n            id=\"userName\">&nbsp;{{user.name|| '游客'+user.id}}</span></div>\n        <div class=' '>\n          <div>\n            <span><b>{{user.email}}</b></span>\n            <span><b>{{user.ip}}</b></span>\n            <span>访问页面：<b>{{user.domain}}</b></span>\n            <span>来源:<b class=\"mr-1\" [title]=\"user.domain\">{{user.mall}}</b></span>\n          </div>\n        </div> \n\n        <table class=\"w-100\">\n          <tr>\n            <td>\n              <i class=\"ml-1 iconfont icon-user text-lighter-base vm\" id=\"userIcon\"></i>\n              <span id=\"userName\">&nbsp;{{user.name|| '游客'+user.id}}</span>\n            </td>\n            <td *ngIf=\"user.email\">\n              <span><b>{{user.email}}</b></span>\n            </td>\n            <td *ngIf=\"user.ip\" class=\"d-480-none\">\n              <span><b>{{user.ip}}</b></span>\n            </td>\n            <td *ngIf=\"user.domain\" class=\"d-768-none\">\n              <span>访问页面：<b>{{user.domain}}</b></span>\n            </td>\n            <td *ngIf=\"user.mall\">\n              <span>来源:<b class=\"mr-1\" [title]=\"user.domain\">{{user.mall}}</b></span>\n            </td>\n          </tr>\n        </table>-->\n\n        <ul class=\"box\">\n          <li class=\"item\">\n            <i class=\"ml-1 iconfont icon-user text-lighter-base vm\" id=\"userIcon\"></i>\n            <span id=\"userName\">&nbsp;{{user.name|| '游客'+user.id}}</span>\n          </li>\n          <li *ngIf=\"user.email\" class=\"item\">\n            <span><b>{{user.email}}</b></span>\n          </li>\n          <li *ngIf=\"user.ip\" class=\"d-480-none item\">\n            <span><b>{{user.ip}}</b></span>\n          </li>\n          <li *ngIf=\"user.domain\" class=\"d-768-none item\">\n            <span>访问页面：<b>{{user.domain}}</b></span>\n          </li>\n          <li *ngIf=\"user.mall\" class=\"item\">\n            <span>来源:<b class=\"mr-1\" [title]=\"user.domain\">{{user.mall}}</b></span>\n          </li>\n        </ul>\n      </div>\n      <div class=\"chat pos-r ie-scroll other-scroll\" id='chat'>\n\n        <div class=\"chat-details\" [style]=\"{'margin-top':(user?42:0)+'px'}\">\n\n          <chat-content [chatList]=\"chatList\"></chat-content>\n          <chat-unread [who]=\"this\" [unread]=\"user?.unread\"></chat-unread>\n\n          <!-- 客户 \n                    <p class=\"dialog\">\n                        <span class=\"iconfont icon-user text-lighter-base vb-before mr-1\"></span>\n                        <span class=\"chat-content  bg-light-base tleft pos-r\">\n                            <span class=\"chat-content-txt text-left client-content \">我为什么购买不成功</span>\n                        </span>\n                    </p>-->\n\n          <!-- 客服 \n                    <p class=\"dialog text-right\">\n\n                        <span class=\"chat-content  bg-light-base tright pos-r mr-1 text-left\">\n                            <span>请问您现在停留在哪个页面，是在订单确认还是银联付款页面?请问您现在停留在哪个页面，是在订单确认还是银联付款页面</span>\n                        </span>\n                        <span class=\"iconfont icon-kefu text-lighter-base vb-before \"></span>\n                    </p>\n                    <p class=\"dialog text-right\">\n\n                        <span class=\"chat-content  bg-light-base tright pos-r mr-1 text-left\">\n                            <span>请问您现在停留在哪个页面，是在订单确认还是银联付款页面?请问您现在停留在哪个页面，是在订单确认还是银联付款页面</span>\n                        </span>\n                        <span class=\"iconfont icon-kefu text-lighter-base vb-before \"></span>\n                    </p>\n                    <p class=\"dialog text-right\">\n\n                        <span class=\"chat-content  bg-light-base tright pos-r mr-1 text-left\">\n                            <span>请问您现在停留在哪个页面，是在订单确认还是银联付款页面?请问您现在停留在哪个页面，是在订单确认还是银联付款页面</span>\n                        </span>\n                        <span class=\"iconfont icon-kefu text-lighter-base vb-before \"></span>\n                    </p>\n                    <p class=\"dialog text-right\">\n\n                        <span class=\"chat-content  bg-light-base tright pos-r mr-1 text-left\">\n                            <span>请问您现在停留在哪个页面，是在订单确认还是银联付款页面?请问您现在停留在哪个页面，是在订单确认还是银联付款页面</span>\n                        </span>\n                        <span class=\"iconfont icon-kefu text-lighter-base vb-before \"></span>\n                    </p>-->\n        </div>\n      </div>\n      <div class=\"edit-area\" id=\"edit\">\n        <edit-operate [who]=\"this\" (historyEmiter)=\"rightHitoryShow($event);\"  (fileEmiter)=\"fileEmiter($event)\"  [toggle]=\"!!rightShow\"></edit-operate>\n        <send-area [who]=\"this\" [keepEnd]=\"keepEnd\"></send-area>\n      </div>\n\n\n\n    </div>\n\n  </div>\n\n</div>\n\n<div class=\"alert d-none\" id=\"alert\">错误提示</div>\n","import { Component, Input, OnInit, SimpleChanges } from '@angular/core';\nimport { ComService } from 'src/app/core/com.service';\n \n@Component({\n  selector: 'chat-content',\n  templateUrl: './chat-content.component.html',\n  styleUrls: ['./chat-content.component.css']\n})\n\nexport class ChatContentComponent implements OnInit {\n  @Input() chatList;\n  constructor(\n    private com:ComService\n  ) { }\n\n  ngOnInit(): void {\n  }\n  \n  clickImg(e){\n    if(e.target.tagName.toLowerCase()==='img'){\n      // 图片点击要放大图片\n      this.com.previewOption.src = e.target.src;\n      this.com.previewOption.isShowMask = true;\n    }\n  }\n}\n","<div *ngFor=\"let c of chatList\">\n  <!-- 时间 -->\n  <p class=\"time\" *ngIf=\"c.timeStr\">{{c.timeStr}}</p>\n  <p class=\"dialog\" [class]=\"c.position?'':'text-right'\">\n    <!-- 自己发送的发送失败显示发送失败 -->\n    <span class=\"uploaded error mr-10\" title=\"发送失败!\" *ngIf=\"!c.position && c.isUploaded===-1\"><span class=\"iconfont icon-error\"></span></span>\n     <!-- 左侧发过来的信息显示发送成功，已读未读   -->\n    <span class=\"uploaded success mr-10\"  [title]=\"c.readed?'对方已读':'对方未读'\" *ngIf=\"!c.position && c.isUploaded ===1\"><span [class]=\"c.readed?'readed':'unread'\"></span></span>\n    <!-- 左边头像 *ngIf=\"c.isUploaded===-1\"-->\n    <span class=\"iconfont text-lighter-base vb-before mr-1\" [class]=\"c.isServer?'icon-server':'icon-user'\"\n      *ngIf=\"c.position\"></span>\n    <span class=\"chat-content  bg-light-base  pos-r\" [class]=\"c.position?'tleft':'tright  mr-1 text-left'\">\n      <!-- 图片或文件显示 -->\n      <span [class]=\"c.position?'chat-content-txt text-left client-content':'' \" *ngIf=\"c.type\">\n        <img [src]=\"c.webSrc || c.src\" *ngIf=\"c.msgType==='img'\" />\n        <i class=\"iconfont \" [class]=\"'icon-'+c.fileType\" *ngIf=\"c.msgType==='file'\"></i>\n        <a class=\"file-name\" [href]=\"c.webSrc||'javascript:;'\" *ngIf=\"c.msgType==='file'\">{{c.name}}</a>\n        <span *ngIf=\"c.uploadProgress > 0 && c.uploadProgress < 100\">\n          上传中：{{c.uploadProgress}}%\n        </span>        \n      </span>\n      <!-- 纯文本|data是html -->\n      <span class=\"chat-content-txt text-left client-content \" *ngIf=\"!c.msgType\"\n        [innerHTML]=\"c.data | toSafe:'html'\" (click)=\"clickImg($event)\"></span>\n      \n    </span>\n   \n    <!-- 右边头像 -->\n    <span class=\"iconfont text-lighter-base vb-before \" *ngIf=\"!c.position\"\n      [class]=\"c.isServer?'icon-server':'icon-user'\"></span>\n  </p>\n\n</div>\n","import { Component, Input, OnInit } from '@angular/core';\n\n@Component({\n  selector: 'chat-unread',\n  templateUrl: './chat-unread.component.html',\n  styleUrls: ['./chat-unread.component.css']\n})\nexport class ChatUnreadComponent implements OnInit {\n\n  constructor() { }\n  @Input() who :any;\n  @Input() unread:number;\n  ngOnInit(): void {\n  }\n  toBottom(){\n    this.who.toBottom();\n  }\n}\n","<div class=\"chat-unread pos-a\" (click)=\"toBottom()\" *ngIf=\"unread\">未读{{unread}}</div>","import { Component, EventEmitter, Output, Input, OnInit } from '@angular/core';\nimport { ComService } from 'src/app/core/com.service';\n\n@Component({\n  selector: 'edit-operate',\n  templateUrl: './edit-operate.component.html',\n  styleUrls: ['./edit-operate.component.css'],\n})\nexport class EditOperateComponent implements OnInit {\n  constructor(private com: ComService) {}\n  @Output() fileEmiter = new EventEmitter();\n  @Output() historyEmiter = new EventEmitter();\n  isServer: boolean = false;\n  @Input() who: any;\n  @Input() toggle: boolean = false;\n  isLogin: boolean = false;\n\n  ngOnInit(): void {\n    this.isServer = 'rid' in this.who;\n  }\n  /* getImage(e) {\n    let file = e.target.files[0];\n    console.log('file: ', file);\n    if (file.type.indexOf('image') > -1) {\n      window.URL = window.URL || window.webkitURL;\n      // this.imgEmiter.emit(window.URL.createObjectURL(file));\n      e.target.value = '';\n    } else {\n      this.com.showAlert('请选择png,jpg,gif图片进行上传');\n    }\n  }\n*/\n  getFile(e) {\n    \n    //  允许的文件类型\n    // .doc application/msword\n    // .docx application/vnd.openxmlformats-officedocument.wordprocessingml.document\n    // .xls application/vnd.ms-excel\n    // .xlsx  application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\n    // .ppt application/vnd.ms-powerpoint\n    // .pptx application/vnd.openxmlformats-officedocument.presentationml.presentation\n    // .pdf application/pdf\n    // .zip application/zip, application/octet-stream, application/x-zip-compressed, multipart/x-zip\n    // .rar application/x-rar-compressed, application/octet-stream\n    // .gz application/x-gzip\n    // .txt 'text/plain'\n    let permitType = [\n      'application/zip',\n      'application/octet-stream',\n      'application/x-zip-compressed',\n      'multipart/x-zip',\n      'application/x-rar-compressed',\n      'application/x-gzip',\n      'application/msword',\n      'application/vnd.openxmlformats-officedocument.wordprocessingml.document',\n      'application/vnd.ms-excel',\n      'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',\n      'application/vnd.ms-powerpoint',\n      'application/vnd.openxmlformats-officedocument.presentationml.presentation',\n      'application/pdf',\n      'text/plain',\n    ];\n   \n    let file = e.target.files[0];\n    if (file.type.indexOf('image') > -1) {\n      // 是图片\n      this.com.preview(file, (src) => {\n        let obj = { type: 'img', fid: 'img' + Date.now(), src, file };\n        this.who.files.push(obj);        \n      });\n      this.fileEmiter.emit(true);\n    } else if (permitType.indexOf(file.type) > -1) {\n      // 是文件\n      let i = permitType.indexOf(file.type);\n      \n      let type =\n        i < 5\n          ? 'zip'\n          : i < 8\n          ? 'doc'\n          : i < 10\n          ? 'xls'\n          : i < 12\n          ? 'ppt'\n          : i === 12\n          ? 'pdf'\n          : 'txt';\n      let obj = {\n        type: 'file',\n        fileType: type,\n        file,\n        name: file.name,\n        fid: 'file' + Date.now(),\n      };\n      this.who.files.push(obj);\n \n       this.fileEmiter.emit(true);\n    } else {\n      this.com.showAlert('不支持此图片/文件格式');\n    }\n    e.target.value = '';\n  }\n\n  getHistory() {\n    // 显示右侧 然后把历史记录放到右侧去\n    if (this.isServer && !this.who.userList.length) return;\n    this.historyEmiter.emit(this.toggle);\n  }\n}\n","<div class=\"op pos-r\">\n    <!-- 选择图片 -->\n    <div class=\"pos-r\" >\n        <span class=\"iconfont icon-photo vm ml-1 csr\"></span>\n        <input type=\"file\" title=\"上传图片/文件\" class=\"pos-a file csr\"   (change)=\"getFile($event)\" [disabled]=\"isServer&& !who.userList.length\"/>\n        \n    </div>\n    <!-- 历史记录 -->\n    <span class=\"pos-a history-clock\" [class]=\"isServer?'':'d-none'\" (click)=\"getHistory()\">\n        <i id=\"historyIcon\" class=\"iconfont icon-clock mr-1 csr\"></i>\n    </span>\n</div>   \n\n","import {\n  Component,\n  EventEmitter,\n  Input,\n  OnInit,\n  Output,\n  SimpleChanges,\n} from '@angular/core';\nimport { ComService } from 'src/app/core/com.service';\n\n@Component({\n  selector: 'send-area',\n  templateUrl: './send-area.component.html',\n  styleUrls: ['./send-area.component.css'],\n})\nexport class SendAreaComponent implements OnInit {\n  @Input() who: any;\n  // @Output() sendListen = new EventEmitter();\n  @Input() keepEnd: boolean = false;\n  isServer: boolean = false;\n  target = null;\n  constructor(private com: ComService) {}\n  hasHolder = true;\n  editText: string = '';\n\n  text = '';\n  ngOnInit(): void {\n    this.target = document.getElementById('editDiv');\n    this.isServer = 'rid' in this.who;\n    this.setEditDivUsable();\n  }\n  ngOnChanges(changes: SimpleChanges): void {\n    if (this.keepEnd) {\n      this.keepLastIndex(this.target);\n    }\n  }\n\n  setBorder(d, e) {\n    d.border = !d.border;\n    let range = document.createRange();\n    range.selectNodeContents(e.target); // document.getElementById('test')\n    range.collapse(false);\n    let sel = window.getSelection();\n    sel.removeAllRanges();\n    sel.addRange(range);\n    this.editFocus();\n  }\n  // 不支持直接粘贴图片的情况下要用到这个函数\n  editPaste(e) {\n    var cbd = e.clipboardData;\n    console.log('editPaste: ', cbd);\n    var ua = window.navigator.userAgent;\n    console.log('ua: ', ua);\n    // 如果是 Safari 直接 return\n    if (!(e.clipboardData && e.clipboardData.items)) {\n      console.log('e.clipboardData: ', e.clipboardData);\n      return;\n    }\n    // Mac平台下Chrome49版本以下 复制Finder中的文件的Bug Hack掉\n    if (\n      cbd.items &&\n      cbd.items.length === 2 &&\n      cbd.items[0].kind === 'string' &&\n      cbd.items[1].kind === 'file' &&\n      cbd.types &&\n      cbd.types.length === 2 &&\n      cbd.types[0] === 'text/plain' &&\n      cbd.types[1] === 'Files' &&\n      ua.match(/Macintosh/i) &&\n      Number(ua.match(/Chrome\\/(\\d{2})/i)[1]) < 49\n    ) {\n      console.log('Mac Chorme49一下不支持贴图');\n      return;\n    }\n    !cbd.items.length && this.com.showAlert('只能粘贴截图');\n    for (var i = 0; i < cbd.items.length; i++) {\n      var item = cbd.items[i];\n      if (item.kind == 'file') {\n        // blob 就是从剪切板获得的文件 可以进行上传或其他操作\n        var blob = item.getAsFile();\n        if (blob.size === 0) {\n          return;\n        }\n      }\n      // 图片就预览 -文件也预览,可以上传的文件blob\n      if (item.type.indexOf('image') > -1) {\n        e.preventDefault();\n        this.com.preview(blob, (src) => {\n          // 如果前面是一个img标签且是data开头\n          this.who.files.push({\n            type: 'img',\n            src,\n            file: blob,\n            fid: 'img' + Date.now(),\n          });\n          this.keepLastIndex(this.target);\n        });\n      }\n    }\n  }\n  // 定位光标到最后\n  keepLastIndex(obj) {\n    if (window.getSelection) {\n      //ie11 10 9 ff safari\n      obj.focus(); //解决ff不获取焦点无法定位问题\n      var range = window.getSelection(); //创建range\n      range.selectAllChildren(obj);\n      range.collapseToEnd();\n    }\n  }\n  setEditDivUsable() {\n    // 服务端判断\n    if (this.isServer) {\n      this.who.userList.length &&\n        this.target.setAttribute('contenteditable', true);\n    } else {\n      this.target.setAttribute('contenteditable', true);\n    }\n  }\n  editFocus() {\n    this.hasHolder = false;\n  }\n  editBlur(e) {\n    this.editText = e.target.innerHTML;\n    this.hasHolder = !this.editText;\n  }\n\n  editInput(e) {\n    // console.log('editInput: ');\n  }\n  editKeyUp(e) {\n    if (e.keyCode === 13) {\n      // 回车发送\n      this.send();\n    }\n  }\n  ngAfterContentChecked(): void {\n    this.setEditDivUsable();\n  }\n  clickImg(e) {\n    this.com.previewOption.isShowMask = true;\n    this.com.previewOption.src = e.target.src;\n  }\n\n  send() {\n    this.editText = this.target.innerHTML;\n    // 去掉注释节点-换行<br>成空\n    let div: any = document.createElement('div');\n    div.innerHTML = this.editText;\n    console.log('div.childNodes',div.childNodes)\n    div.removeChild(div.childNodes[div.childNodes.length - 1]);\n    let editTxt = div.innerHTML;\n    editTxt = editTxt.replace(/<br>/g, '').trim();\n\n    if (editTxt) {\n      // 分析editText\n      let content: any = { data: editTxt, mark: Date.now().toString() };\n      // 显示到聊天框右侧\n      content.isServer = this.isServer;\n      content.position = false;\n      this.who.chatList.push(content);\n      this.isServer && (content.rid = this.who.user.id);\n      this.who.toBottom();\n\n      let count = 0;\n      this.who.files.forEach((file, i) => {\n        this.editText.indexOf(file.fid) === -1 && this.who.files.splice(i, 1);\n      });\n      if (this.who.files.length) {\n        // 判断files 有没有删除掉\n        this.who.files.forEach((el) => {\n          this.com.uploadFile(\n            el,\n            (file, err?) => {\n              if (err) {\n                // 发送失败\n                let i = this.who.chatList.findIndex(\n                  (x) => x.mark === content.mark\n                );\n                i > -1 && (this.who.chatList[i].isUploaded = -1);\n              } else {\n                count++;\n                let span = null;\n                console.log(div.childNodes);\n                Array.from(div.childNodes).forEach((el: any) => {\n                  console.log('el.id: ', el.id);\n                  console.log('file.fid', file.fid);\n                  el.id === file.fid && (span = el);\n                });\n                try {\n                  if (file.type === 'img') {\n                    span.children[0].setAttribute('src', file.src);\n                  } else if (file.type === 'file') {\n                    span.children[1].setAttribute('href', file.src);\n                    span.children[1].setAttribute('download', file.name);\n                  }\n                } catch (e) {}\n                if (count === this.who.files.length) {\n                  content.data = div.innerHTML;\n                  this.sendMsg(content);\n                }\n              }\n            },\n            (file) => {\n              // chatList 显示进度条\n              // content.uploadProgress = file.uploadProgress;\n            }\n          );\n        });\n      } else {\n        // 没有文件时\n        this.sendMsg(content);\n      }\n    } else {\n      this.com.showAlert('请填写消息');\n    }\n    let lastNode = this.target.childNodes[this.target.childNodes.length - 1];\n    this.target.innerHTML = '';\n    this.target.appendChild(lastNode);\n  }\n  sendMsg(content) {\n    this.com.sendMsg(\n      content,\n      (data) => {\n        this.who.files = [];\n        let i = this.who.chatList.findIndex((x) => x.mark === content.mark);\n        i > -1 && (this.who.chatList[i].isUploaded = 1);\n        setTimeout(() => {\n          this.who.toBottom();\n        }, 1000);\n      },\n      (res) => {\n        // 失败-客户端就显示失败的消息到聊天框\n        if (res && res.msg === '客服不在线') {\n          let offline: any = {\n            data: '客服不在线,请过几分钟后再访问',\n            mark: Date.now().toString(),\n          };\n          offline.isServer = true;\n          offline.position = true;\n          this.who.chatList.push(offline);\n          setTimeout(() => {\n            this.who.toBottom();\n          }, 1000);\n        } else {\n          let i = this.who.chatList.findIndex((x) => x.mark === content.mark);\n          i > -1 && (this.who.chatList[i].isUploaded = -1);\n        }\n      }\n    );\n  }\n}\n","<div class=\"send-area clearfix\">\n  <div name=\"editText\" class=\"textarea pos-r  vm  ie-scroll other-scroll\"\n    [class]=\"hasHolder?(isServer && !who.userList.length?'placeholder-disabled':'placeholder'):''\" (focus)=\"editFocus()\"\n    (blur)=\"editBlur($event)\" (input)=\"editInput($event)\" (keyup)=\"editKeyUp($event)\" id=\"editDiv\"\n    (paste)=\"editPaste($event)\">\n\n    <span *ngFor=\"let d of who.files\" contenteditable=\"false\" [class]=\"{border:d.border,'file-box':d.type==='file'}\"\n       [id]=\"d.fid\" class=\"d-inline-block \">\n      <!-- 图片-->\n      <img [src]=\"d.src\" *ngIf=\"d.type==='img'\" onerror=\"this.src='/assets/images/error.jpg'\" (click)=\"clickImg($event)\"/>\n\n      <!-- 文件 -->\n      <i class=\"iconfont \" [class]=\"'icon-'+d.fileType\" *ngIf=\"d.type==='file'\"></i>\n      <a class=\"file-name\" [href]=\"d.src||'javascript:;'\" *ngIf=\"d.type==='file'\" [title]=\"d.name\">{{d.name}}</a>\n\n      <!-- 文字 \n      <span *ngIf=\"!d.type\">{{d.data}}</span>-->\n    </span>\n\n\n  </div>\n\n\n\n\n  <button class=\"bg-light-base fr vm csr\" (click)=\"send()\" [disabled]=\"isServer && !who.userList.length\">发送</button>\n</div>\n",";(function (undefined) {\n    var _global;\n    //工具函数\n    //配置合并\n    function extend (def,opt,override) {\n        for(var k in opt){\n            if(opt.hasOwnProperty(k) && (!def.hasOwnProperty(k) || override)){\n                def[k] = opt[k]\n            }\n        }\n        return def;\n    }\n    //日期格式化\n    function formartDate (y,m,d,symbol) {\n        symbol = symbol || '-';\n        m = (m.toString())[1] ? m : '0'+m;\n        d = (d.toString())[1] ? d : '0'+d;\n        return y+symbol+m+symbol+d\n    }\n \n    function Schedule (opt) {\n        var def = {},\n            opt = extend(def,opt,true),\n            curDate = opt.date ? new Date(opt.date) : new Date(),\n            year = curDate.getFullYear(),\n            month = curDate.getMonth(),\n            day = curDate.getDate(),  \n            currentYear = curDate.getFullYear(),\n            currentMonth = curDate.getMonth(),\n            currentDay = curDate.getDate(),\n            selectedDate = '',\n            el = document.querySelector(opt.el) || document.querySelector('body'),\n            _this = this;\n        var bindEvent = function (){\n            el.addEventListener('click',function(e){\n                switch (e.target.id) {\n                    case 'nextMonth': \n                        _this.nextMonthFun();\n                        break;\n                    case 'nextYear': \n                        _this.nextYearFun();\n                        break;\n                    case 'prevMonth': \n                        _this.prevMonthFun();\n                        break;\n                    case 'prevYear': \n                        _this.prevYearFun();\n                        break;\n                    default:\n                        break;\n                };\n                if(e.target.className.indexOf('currentDate') > -1){\n                    opt.clickCb && opt.clickCb(year, month+1, e.target.innerHTML);\n                    selectedDate = e.target.title;\n                    day = e.target.innerHTML;\n                    render();\n                }\n            },false)\n        }\n        var init = function () {\n            var scheduleHd = '<div class=\"schedule-hd\">'+\n                                '<div>'+\n                                    '<span class=\"icon iconfont icon-double-less-than\" id=\"prevYear\" title=\"上一年\"></span>'+\n                                    '<span class=\"arrow icon iconfont icon-less-than\" id=\"prevMonth\" title=\"上一月\"></span>'+\n                                '</div>'+\n                                '<div class=\"today\">'+formartDate(year,month+1,day,'-')+'</div>'+\n                                '<div>'+\n                                    '<span class=\"arrow icon iconfont icon-great-than\" id=\"nextMonth\" title=\"下一月\"></span>'+\n                                    '<span class=\"arrow icon iconfont icon-double-great-than\" id=\"nextYear\" title=\"下一年\"></span>'+\n                                '</div>'+\n                            '</div>'\n            var scheduleWeek = '<ul class=\"week-ul ul-box\">'+\n                                    '<li class=\"text-red\">日</li>'+\n                                    '<li>一</li>'+\n                                    '<li>二</li>'+\n                                    '<li>三</li>'+\n                                    '<li>四</li>'+\n                                    '<li>五</li>'+\n                                    '<li class=\"text-red\">六</li>'+\n                                '</ul>'\n            var scheduleBd = '<ul class=\"schedule-bd ul-box bg-white\" ></ul>'; \n            el.innerHTML = scheduleHd + scheduleWeek + scheduleBd;\n            bindEvent();\n            render();\n        }\n        var render = function () {\n            var fullDay = new Date(year,month+1,0).getDate(), //当月总天数\n            startWeek = new Date(year,month,1).getDay(), //当月第一天是周几\n            total = (fullDay+startWeek)%7 == 0 ? (fullDay+startWeek) : fullDay+startWeek+(7-(fullDay+startWeek)%7),//元素总个数\n            lastMonthDay = new Date(year,month,0).getDate(), //上月最后一天\n            eleTemp = [];\n            if(day > fullDay){\n                day = fullDay\n            }\n            for(var i = 0; i < total; i++){\n                if(i<startWeek){\n                    eleTemp.push('<li class=\"other-month\"><span class=\"dayStyle\">'+(lastMonthDay-startWeek+1+i)+'</span></li>')\n                }else if(i<(startWeek+fullDay)){\n                    var nowDate = formartDate(year,month+1,(i+1-startWeek),'-');\n                    var addClass = '';\n                    selectedDate == nowDate && (addClass = 'selected-style');\n                    formartDate(currentYear,currentMonth+1,currentDay,'-') == nowDate && (addClass = 'today-flag');\n                    eleTemp.push('<li class=\"current-month\" ><span title='+nowDate+' class=\"currentDate dayStyle '+addClass+'\">'+(i+1-startWeek)+'</span></li>')\n                }else{\n                    eleTemp.push('<li class=\"other-month\"><span class=\"dayStyle\">'+(i+1-(startWeek+fullDay))+'</span></li>')\n                }\n            }\n            el.querySelector('.schedule-bd').innerHTML = eleTemp.join('');\n            el.querySelector('.today').innerHTML = formartDate(year,month+1,day,'-');\n        };\n        this.nextMonthFun = function () {\n            if(month+1 > 11){\n                year += 1;\n                month = 0;\n            }else{\n                month += 1;\n            }\n            render();\n            opt.nextMonthCb && opt.nextMonthCb(year,month+1,day);\n        },\n        this.nextYearFun = function () {\n            year += 1;\n            render();\n            opt.nextYeayCb && opt.nextYeayCb(year,month+1,day);\n        },\n        this.prevMonthFun = function () {\n            if(month-1 < 0){\n                year -= 1;\n                month = 11;\n            }else{\n                month -= 1;\n            }\n            render();\n            opt.prevMonthCb && opt.prevMonthCb(year,month+1,day);\n        },\n        this.prevYearFun = function () {\n            year -= 1;\n            render();\n            opt.prevYearCb && opt.prevYearCb(year,month+1,day);\n        }\n        init();\n    }\n    //将插件暴露给全局对象\n    _global = (function(){return this || (0,eval)('this')}());\n    if(typeof module !== 'undefined' && module.exports){\n        module.exports = Schedule;\n    }else if (typeof define === \"function\" && define.amd){\n        define(function () {\n            return Schedule;\n        })\n    }else {\n        !('Schedule' in _global) && (_global.Schedule = Schedule);\n    }\n \n}());","// This file can be replaced during build by using the `fileReplacements` array.\n// `ng build --prod` replaces `environment.ts` with `environment.prod.ts`.\n// The list of file replacements can be found in `angular.json`.\n\nexport const environment = {\n  production: false\n};\n\n/*\n * For easier debugging in development mode, you can import the following file\n * to ignore zone related error stack frames such as `zone.run`, `zoneDelegate.invokeTask`.\n *\n * This import should be commented out in production mode because it will have a negative impact\n * on performance if an error is thrown.\n */\n// import 'zone.js/dist/zone-error';  // Included with Angular CLI.\n","import { enableProdMode } from '@angular/core';\nimport { platformBrowserDynamic } from '@angular/platform-browser-dynamic';\n\nimport { AppModule } from './app/app.module';\nimport { environment } from './environments/environment';\n\nif (environment.production) {\n  enableProdMode();\n}\n\nplatformBrowserDynamic().bootstrapModule(AppModule)\n  .catch(err => console.error(err));\n"]}